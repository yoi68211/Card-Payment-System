<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link th:href="@{/css/pageSample.css}" rel="stylesheet">
    <link th:href="@{/css/list.css}" rel="stylesheet">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://kit.fontawesome.com/047f82d071.js" crossorigin="anonymous"></script>
</head>
<body>
<header class="header-nav">
    <span class="header-flex-box">
        <i class="fa-solid fa-list" id="sidebar-action-icon"></i>
         AIP System
    </span>

    <span class="header-pageName header-flex-box" >결제목록 / 전체 결제 목록</span><!-- 현재 페이지 이름 -->

    <span class="header-flex-box">
        <span class="header-flex-three">
            <span class="header-icon">
                <a href=""><i class="fa-solid fa-circle-question fa-xl"></i></a>
                <a href="#"><i class="fa-solid fa-comment-dots fa-xl"></i></a>
            </span>
            <img th:src="@{/img/defaultImg.png}" id="profile-img">
            <span id="submenu-trigger">
                <a href="#">Nacamora</a>
                <div id="submenu">
                    <a href="#">정보 변경</a>
                    <a href="#">비밀번호 변경</a>
                    <a href="#">로그아웃</a>
                </div>
            </span>
        </span>
    </span>
</header>
<main>
    <div class="main_cell">
        <!-- 여기서 작업하시면 됩니다. -->
        <div class="title">전체 결제 목록</div>
        <button class="right_button" onclick="toggleContent()"><i class="fas fa-caret-down"></i>상세 검색</button>
        <div class="line"></div> <!-- 버튼 아래에 위치한 첫 번째 선 -->
        <div class="expandableContent" id="expandableContent">
            <form id="form" th:action="@{/search}" th:object="${searchDTO}" method="get">
                <table class="date">
                    <tr>
                        <td colspan="2">
                            <label class="re_time">조회기간</label>
                            <input type="text" id="startDt" class="startDt" name="startDt" th:value="${startDt}" placeholder="yyyy-mm-dd"> ~
                            <input type="text" id="endDt" class="endDt" name="endDt" th:value="${endDt}" placeholder="yyyy-mm-dd">
                        </td>
                        <td>
                            <label class="status">상태유형</label>
                            <input type="hidden" id="status" name="status" th:value="${status}">
                            <button type="button" onclick="setStatus('')">전체</button>
                            <button type="button" onclick="setStatus('paid')">결제</button>
                            <button type="button" onclick="setStatus('wait')">미결제</button>
                            <button type="button" onclick="setStatus('refund')">환불</button>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <button type="button" onclick="setDateRange(1)">1개월</button>
                            <button type="button" onclick="setDateRange(3)">3개월</button>
                            <button type="button" onclick="setDateRange(6)">6개월</button>
                            <button type="button" onclick="setDateRange(12)">1년</button>
                        </td>
                        <td>
                            <label for="docNumber">문서번호</label>
                            <input type="text" id="docNumber" name="docNumber" th:value="${docNumber}" placeholder="문서번호를 입력해주세요.">
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2">
                            <label for="customerName">고객이름</label>
                            <input type="text" id="customerName" name="customerName" th:value="${customerName}" placeholder="이름을 입력해주세요.">
                        </td>
                        <td>
                            <label for="email">메일주소</label>
                            <input type="email" id="email" name="email" th:value="${email}" placeholder="메일을 입력해주세요.">
                        </td>
                    </tr>
                    <tr>
                        <td colspan="3" style="text-align: right;">
                            <button type="button" onclick="resetForm()">초기화</button>
                            <button type="button" onclick="submitForm()">조회</button>
                        </td>
                    </tr>
                </table>
            </form>
        </div>
        <div class="line2"></div> <!-- 버튼 아래에 위치한 두 번째 선 -->

        <div>
            <form id="deleteForm" action="/delete/{id}" method="post">
                <!-- 선택된 결제 ID를 서버로 전송하기 위한 폼 -->
                <input type="hidden" id="paymentIds" name="paymentIds">
                <!-- 삭제 버튼 클릭 시 서버로 전송하도록 type을 submit으로 변경 -->
                <button id="deleteButton" type="submit" onclick="deleteSelectedPayments()" disabled>삭제</button>
            </form>
            <form th:action="@{/list}" method="get" id="searchForm">
                <input type="text" id="searchInput" name="keyword" placeholder="검색어를 입력해 주세요">
            </form>
        </div>

        <table class="custom-table" border="1">
            <thead>
            <tr>
                <th>선택</th>
                <th>등록일시</th>
                <th>문서번호</th>
                <th>고객명</th>
                <th>제목</th>
                <th>금액</th>
                <th>상태</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="payment : ${payList}">
                <td><label><input type="checkbox" name="selectedPayment" th:value="${payment.id}" onchange="toggleDeleteButton()" /></label></td>
                <td th:text="${#temporals.format(payment.createTime, 'yyyy-MM-dd HH:mm:ss')}"></td>
                <td th:text="${payment.id}"></td>
                <td th:text="${payment.customerName}"></td>
                <td th:text="${payment.paymentTitle}"></td>
                <td th:text="${payment.totalAmount}"></td>
                <td th:text="${payment.paymentStatus}"></td>
            </tr>
            </tbody>
        </table>

        <div>
            <select id="pageSelect" onchange="changePageSize()">
                <option value="10" th:selected="${payList.size == 10}">10건</option>
                <option value="30" th:selected="${payList.size == 30}">30건</option>
                <option value="50" th:selected="${payList.size == 50}">50건</option>
            </select>
            <p>(데이터 총 <span th:text="${payCount}"></span>건)</p>
            <nav aria-label="Page navigation">
                <ul class="pagination">
                    <!-- 이전 페이지 -->
                    <li th:if="${payList.hasPrevious()}" class="page-item">
                        <a class="page-link" th:href="@{'/list?page=' + (${payList.getNumber()} - 1) + '&amp;size=' + ${payList.getSize()} + '&amp;keyword=' + ${keyword != null ? keyword : ''}}" aria-label="Previous">
                            <span aria-hidden="true">&laquo;</span>
                        </a>
                    </li>
                    <!-- 페이지 번호 -->
                    <li th:each="i : ${#numbers.sequence((payList.number - 3) < 0 ? 0 : (payList.number - 3), (payList.number + 3) > (payList.totalPages - 1) ? (payList.totalPages - 1) : (payList.number + 3))}" th:class="${payList.number == i} ? 'page-item active' : 'page-item'">
                        <a class="page-link" th:href="@{'/list?page=' + ${i} + '&amp;size=' + ${payList.getSize()} + '&amp;keyword=' + ${keyword != null ? keyword : ''}}" th:text="${i + 1}"></a>
                    </li>
                    <!-- 다음 페이지 -->
                    <li th:if="${payList.hasNext()}" class="page-item">
                        <a class="page-link" th:href="@{'/list?page=' + (${payList.getNumber()} + 1) + '&amp;size=' + ${payList.getSize()} + '&amp;keyword=' + ${keyword != null ? keyword : ''}}" aria-label="Next">
                            <span aria-hidden="true">&raquo;</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>

        <script th:src="@{/js/list.js}"></script>

    </div>
</main>
<aside>
<span id="sidebar">
    <nav>
        <ul>
            <li> <!-- 현재 페이지 의 해당하는 span태그에 style="color: blue;" 써주세여  -->
                <span>
                    <i class="fa-solid fa-table-cells"></i>
                    <span class="sidebar-nav-text">DashBoard</span>
                </span>
                <i class="fa-solid fa-chevron-right"></i>
            </li>
            <li>
                <span>
                    <i class="fa-solid fa-credit-card"></i>
                    <span class="sidebar-nav-text">결제등록</span>
                </span>
                <i class="fa-solid fa-chevron-right"></i>
            </li>
            <li>
                <span style="color: blue;">
                    <i class="fa-solid fa-rectangle-list"></i>
                    <span class="sidebar-nav-text">결제목록</span>
                </span>
                <i class="fa-solid fa-chevron-down" id="payList-toggle"></i>
            </li>
            <li class="payList-nav">
                <span class="payList" style="color: blue;">
                    <i class="fa-solid fa-square fa-2xs"></i>
                    <span class="sidebar-nav-text">전체 결제 목록</span>
                </span>
                <!-- <i class="fa-solid fa-chevron-right"></i> -->
            </li>
            <li class="payList-nav">
                <span class="payList">
                    <i class="fa-solid fa-square fa-2xs"></i>
                    <span class="sidebar-nav-text" >자동 결제 목록</span>
                </span>
                <!-- <i class="fa-solid fa-chevron-right"></i> -->
            </li>
        </ul>
    </nav>
    </span>
</aside>
</body>
<script th:src="@{/js/pageSample.js}"></script>
</html>